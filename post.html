<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Filmixo - Download & Watch</title>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">  
    <style>  
    /* --- ‡¶¨‡ßá‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü --- */  
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; text-decoration: none; }  
    body { background: #fff; display: flex; justify-content: center; }  

    /* ‡¶Æ‡ßá‡¶á‡¶® ‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡¶æ‡¶∞ */  
    .main-wrapper {   
        width: 100%;   
        max-width: 600px;   
        min-height: 100vh;   
        background: #fff;   
        position: relative;   
        border-left: 1px solid #eee;   
        border-right: 1px solid #eee;   
        padding-bottom: 0;   
        opacity: 0;   
        transition: opacity 0.3s ease;
    }  
    .main-wrapper.loaded { opacity: 1 !important; }  

    /* ‡¶π‡ßá‡¶°‡¶æ‡¶∞ */  
    header {   
        background: #1da1f2; padding: 12px 15px; display: flex; justify-content: space-between;   
        align-items: center; color: white; position: sticky; top: 0; z-index: 100;   
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);  
    }  
    .logo-area { font-weight: 800; font-size: 20px; text-transform: uppercase; }  
    .header-btn { background: white; color: #1da1f2; padding: 6px 15px; border-radius: 20px; font-weight: bold; font-size: 14px; margin-left: 10px; cursor: pointer; }  

    /* ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ */  
    .post-author-area { padding: 10px 15px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #e1e8ed; }  
    .author-info { display: flex; align-items: center; gap: 10px; }  
    .pfp { width: 45px; height: 45px; border-radius: 50%; overflow: hidden; background: #ddd; }  
    .pfp img { width: 100%; height: 100%; object-fit: cover; }  
    .author-text h3 { font-size: 16px; margin: 0; color: #0f1419; display: inline-flex; align-items: center; }  
    .author-text span { font-size: 14px; color: #1da1f2; display: block; margin-top: -2px; }  
    .post-time { font-size: 13px; color: #536471; font-weight: bold; }  

    /* ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞ */  
    .video-container { width: 100%; aspect-ratio: 16/9; background: #000; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-top: 5px; cursor: pointer; }  
    .video-container img { width: 100%; height: 100%; object-fit: contain; }  
    .play-btn-center { position: absolute; width: 60px; height: 60px; background: rgba(0,0,0,0.6); border-radius: 50%; border: 3px solid #fff; display: flex; align-items: center; justify-content: center; z-index: 5; pointer-events: none; }  
    .play-btn-center::after { content: ''; border-left: 20px solid white; border-top: 12px solid transparent; border-bottom: 12px solid transparent; margin-left: 5px; }  
    .main-video-spinner { display: none; position: absolute; width: 50px; height: 50px; border: 5px solid rgba(255, 255, 255, 0.3); border-top: 5px solid #fff; border-radius: 50%; animation: spin 1s linear infinite; z-index: 6; }  
    .video-controls { position: absolute; bottom: 0; left: 0; width: 100%; padding: 10px; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; display: flex; justify-content: space-between; font-size: 12px; z-index: 5; }  

    .content-body { padding: 15px 15px 0 15px; }  
    .article-title { font-size: 20px; font-weight: 800; margin-bottom: 15px; color: #0f1419; line-height: 1.3; }  
    .article-para { font-size: 15px; line-height: 1.2; color: #1c1e21; margin-bottom: 12px; text-align: left; letter-spacing: -0.3px; }  

    /* --- ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® --- */  
    .download-title-text { font-size: 18px; font-weight: 800; color: #0f1419; text-align: center; margin: 20px 0 10px 0; padding: 0 15px; border-top: 1px solid #e1e8ed; padding-top: 15px; }  
    .download-buttons-container { padding: 0 15px; margin-bottom: 20px; display: flex; flex-direction: column; gap: 12px; }  
    
    .download-btn-v2 { display: flex; align-items: center; justify-content: center; width: 100%; padding: 14px 10px; border-radius: 8px; font-weight: bold; font-size: 15px; text-align: center; color: white; cursor: pointer; text-transform: uppercase; box-shadow: 0 3px 6px rgba(0,0,0,0.15); transition: all 0.3s; position: relative; overflow: hidden; }  
    .download-btn-v2:active { transform: scale(0.98); }  

    /* ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡ßá‡¶° ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .download-btn-v2.visited-btn {
        background-color: #28a745 !important; /* Green */
        opacity: 0.6;
        cursor: default;
        pointer-events: none;
    }
    .download-btn-v2.visited-btn::after {
        content: ' \f00c'; /* FontAwesome check */
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        margin-left: 8px;
    }

    /* ‡¶°‡¶ø‡¶ú‡ßá‡¶¨‡¶≤ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶Ø‡¶ñ‡¶® ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶ö‡¶≤‡¶õ‡ßá) */
    .download-btn-v2.processing {
        opacity: 0.7;
        pointer-events: none;
    }

    /* ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .final-download-btn {
        display: none; /* ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã */
        background: #e0245e !important;
        animation: pulse 1.5s infinite;
        border: 2px solid white;
    }
    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(224, 36, 94, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(224, 36, 94, 0); }
        100% { box-shadow: 0 0 0 0 rgba(224, 36, 94, 0); }
    }

    /* ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ ‡¶ì ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞ */  
    .stats-section { padding: 12px 0; margin-top: 15px; border-top: 1px solid #e1e8ed; border-bottom: 1px solid #e1e8ed; display: flex; align-items: center; background: #fff; }  
    .stats-left { display: flex; align-items: center; gap: 20px; flex-grow: 1; overflow: hidden; }  
    .view-stat { flex: 0 0 auto; display: flex; align-items: center; gap: 5px; font-weight: 500; font-size: 15px; color: #536471; }  
    .like-stat-container { flex: 1 1 auto; display: flex; justify-content: center; }  
    .love-btn { display: flex; align-items: center; gap: 5px; font-weight: 500; font-size: 15px; color: #536471; cursor: pointer; padding: 5px 10px; border-radius: 20px; transition: 0.2s; user-select: none; }  
    .love-btn.liked { color: #e0245e; } .love-btn.liked i { font-weight: 900; }  
    .share-icons { flex: 0 0 auto; display: flex; gap: 8px; }  
    .share-icon { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; cursor: pointer; font-size: 13px; transition: 0.2s; }  

    /* ‡¶∞‡¶ø‡¶≤‡ßá‡¶ü‡ßá‡¶° ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */  
    .related-section { background: #fff; margin-top: 0; }  
    .related-header { padding: 15px; font-weight: 800; color: #536471; border-bottom: 1px solid #e1e8ed; text-transform: uppercase; background: #fff; }  
    .post-card { background: white; padding: 5px 15px 5px 15px; border-bottom: 1px solid #e1e8ed; display: flex; flex-direction: column; gap: 6px; }  
    .post-header { display: flex; gap: 10px; align-items: center; }  
    .post-pfp { width: 45px; height: 45px; border-radius: 50%; overflow: hidden; background: #ddd; }  
    .post-pfp img { width: 100%; height: 100%; object-fit: cover; }  
    .post-meta-text { display: flex; flex-direction: column; justify-content: center; }  
    .name-row { display: flex; align-items: center; gap: 5px; flex-wrap: wrap; }   
    .name-row h3 { font-size: 18px; font-weight: 800; color: #0f1419; margin: 0; display: inline-flex; align-items: center; }  
    .post-username { font-size: 14px; color: #1da1f2; margin-top: 0; }  
    .verified-badge { color: #1da1f2; font-size: 16px; margin-left: 5px; margin-right: 2px; display: inline-flex; align-items: center; }  
    .time-ago { font-size: 15px; color: #536471; }  
    .dot-separator { font-size: 15px; color: #536471; margin: 0 2px; }  
    .post-title { font-size: 18px; font-weight: 700; color: #0f1419; margin-bottom: 8px; margin-top: -3px; line-height: 1.3; }  
    .post-excerpt { font-size: 15px; color: #0f1419; line-height: 1.4; margin-bottom: 8px; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical; overflow: hidden; }  
    .read-more-text { color: #1da1f2; font-weight: 600; font-size: 14px; }  
    .hashtags { color: #1d9bf0; font-size: 15px; margin-bottom: 10px; cursor: default; }  
    .media-container { position: relative; width: 100%; border-radius: 12px; overflow: hidden; margin-top: 5px; display: block; cursor: pointer; background: #000; aspect-ratio: 3 / 4; max-height: 720px; }  
    .media-container img { width: 100%; height: 100%; display: block; object-fit: cover; margin: 0 auto; max-height: none; }  
    .media-container.auto-fit { aspect-ratio: initial; height: auto; }  
    .media-container.auto-fit img { height: auto; object-fit: contain; }  
    .play-icon { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60px; height: 60px; background-color: rgba(0, 0, 0, 0.6); border-radius: 50%; display: flex; justify-content: center; align-items: center; pointer-events: none; border: 2px solid rgba(255,255,255,0.8); }  
    .play-icon::after { content: ''; display: block; width: 0; height: 0; border-left: 18px solid white; border-top: 11px solid transparent; border-bottom: 11px solid transparent; margin-left: 4px; }  
    .duration-badge { position: absolute; bottom: 8px; right: 8px; background-color: rgba(0, 0, 0, 0.8); color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px; font-weight: bold; pointer-events: none; z-index: 5; }  
    .post-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 12px; color: #536471; font-size: 16px; font-weight: 500; }  
    .footer-left { display: flex; align-items: center; gap: 6px; }  
    .footer-right { display: flex; align-items: center; gap: 20px; }  
    .love-btn-rel { cursor: pointer; display: flex; align-items: center; gap: 5px; transition: all 0.2s; user-select: none; }  
    .love-btn-rel:hover { color: #e0245e; background-color: rgba(224, 36, 94, 0.1); padding: 4px 8px; border-radius: 15px; margin: -4px -8px; }  
    .love-btn-rel.liked { color: #e0245e !important; } .love-btn-rel.liked i { font-weight: 900; }  
    .footer-share-btn { cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; }  
    .footer-share-btn:hover { background-color: rgba(0,0,0,0.05); }  

    /* ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶≤‡ßã‡¶°‡¶æ‡¶∞ */  
    .site-footer { background-color: #fff; padding: 30px 20px; text-align: center; border-top: none; margin-top: 0; }  
    .footer-links { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 15px; }  
    .footer-links a { color: #536471; font-size: 14px; font-weight: 500; transition: color 0.2s; }  
    .footer-copyright { color: #536471; font-size: 13px; }  
    .notification { position: fixed; top: 70px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.85); color: white; padding: 10px 20px; border-radius: 30px; z-index: 1002; opacity: 0; transition: 0.3s; pointer-events: none; }  
    .notification.show { opacity: 1; }  

    /* ‡¶≤‡ßã‡¶° ‡¶Æ‡ßã‡¶∞ ‡¶∏‡ßç‡¶™‡¶ø‡¶®‡¶æ‡¶∞ */
    #sentinel { width: 100%; height: 50px; display: flex; align-items: center; justify-content: center; }  
    .load-more-spinner { width: 24px; height: 24px; border: 3px solid #ccc; border-top: 3px solid #1da1f2; border-radius: 50%; animation: spin 1s linear infinite; display: none; }  
    #sentinel.loading .load-more-spinner { display: block; }  
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }  
</style>

</head>  
<body>  
<div class="main-wrapper">  
    <header>  
        <div class="logo-area">FILMIXO</div>  
        <div>  
            <span class="header-btn" onclick="window.location.href='https://prototypesorting.com/p99vwjq2?key=57217116cccb25526dfb6a5a4edd9aea'">Sign Up</span>  
            <span class="header-btn" onclick="window.location.href='index.html'">Home</span>  
        </div>  
    </header>  
    
    <div id="post-details-container"></div>  

    <div class="related-section" id="related-section-id">  
        <div class="related-header">RELATED POSTS</div>  
        <div id="related-posts-container"></div>  
        <div id="sentinel"><div class="load-more-spinner"></div></div>  
    </div>  

    <footer class="site-footer">  
        <div class="footer-links">  
            <a href="#" id="link-about">About</a>  
            <a href="#" id="link-contact">Contact</a>  
            <a href="#" id="link-privacy">Privacy Policy</a>  
            <a href="#" id="link-terms">Terms of Service</a>  
        </div>  
        <div class="footer-copyright">  
            Copyright ¬© 2026 <a href="index.html">Filmixo.com</a>. All rights reserved.  
        </div>  
    </footer>  
    <div id="notification" class="notification"></div>
</div>  

<script type="module">  
    // Firebase SDK Imports  
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";  
    import { getFirestore, doc, getDoc, setDoc, increment, onSnapshot } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";  
  
    // ============================================  
    //  GLOBAL & TRACKING LOGIC  
    // ============================================  
    
    // ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶ß‡ßç‡¶∞‡ßÅ‡¶¨‡¶ï
    const MIN_VISIT_TIME_MS = 5000; // ‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°
    const PERMANENT_PROFILE_IMAGE_URL = "https://raw.githubusercontent.com/Filmixo/movie/refs/heads/main/Image Files/FILMIXO.jpg";  
    
    const firebaseConfig = { apiKey: "AIzaSyCAsD8wucLsudzY5oNbiixLGyjN2apdV0Q", authDomain: "my-ad-analytics-4560a.firebaseapp.com", databaseURL: "https://my-ad-analytics-4560a-default-rtdb.firebaseio.com", projectId: "my-ad-analytics-4560a", storageBucket: "my-ad-analytics-4560a.firebasestorage.app", messagingSenderId: "104213283950", appId: "1:104213283950:web:b5a25ecd54df809625127f", measurementId: "G-WS7QSQ9H0Y" };  
    const app = initializeApp(firebaseConfig);  
    const db = getFirestore(app);  
    
    // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™
    let deviceId = localStorage.getItem('deviceId');
    if (!deviceId) {
        deviceId = 'deviceId-' + Date.now();
        localStorage.setItem('deviceId', deviceId);
    }
    
    // URL ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶Ü‡¶á‡¶°‡¶ø ‡¶®‡ßá‡¶ì‡ßü‡¶æ
    const urlParams = new URLSearchParams(window.location.search);  
    const postId = urlParams.get('id');  
    
    // ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç ‡¶ï‡¶ø (Keys) ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶∂‡¶®
    const LAST_CLICK_TIME_KEY = `last_click_time_${deviceId}`;
    const LAST_CLICKED_AD_TYPE_KEY = `last_clicked_ad_type_${postId}`;
    const FINAL_BUTTON_VISIBLE_KEY = `final_btn_visible_${postId}`;
    
    const getVisitedKey = (type) => `visited_${type}_${postId}`;

    // --- Window Scope Functions for Buttons ---
    
    // ‡ßß. ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
    window.handleAdClick = function(type, adUrl) {
        // ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá ‡¶•‡¶æ‡¶ï‡ßá
        if (localStorage.getItem(getVisitedKey(type)) === 'true') {
            showNotification("Already Visited! ‚úÖ");
            return;
        }

        // ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶ü‡¶æ‡¶á‡¶™ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ
        localStorage.setItem(LAST_CLICK_TIME_KEY, Date.now());
        localStorage.setItem(LAST_CLICKED_AD_TYPE_KEY, type);

        // UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü (‡¶¨‡ßã‡¶ù‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ö‡¶≤‡¶õ‡ßá)
        const btn = document.getElementById(`btn-${type}`);
        if(btn) {
            btn.style.opacity = '0.5';
            btn.style.pointerEvents = 'none';
        }

        // ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü
        window.open(adUrl, '_blank');
    };

    // ‡ß®. ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
    window.handleFinalDownload = function(finalUrl) {
        // ‡¶∏‡¶¨ ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ (‡¶∞‡¶ø‡¶∏‡ßá‡¶ü)
        localStorage.removeItem(getVisitedKey('ad1080'));
        localStorage.removeItem(getVisitedKey('ad720'));
        localStorage.removeItem(FINAL_BUTTON_VISIBLE_KEY);
        
        // ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶¨‡¶æ ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü
        showNotification("Starting Download... üì•");
        
        // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡¶æ
        setTimeout(() => {
            window.location.href = finalUrl;
            // ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶™‡ßá‡¶ú ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá: location.reload();
            updateButtonVisibilityAndStatus();
        }, 1000);
    };

    // ‡ß©. ‡¶™‡ßá‡¶ú ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶°‡¶ø‡¶ü‡ßá‡¶ï‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á‡¶ï‡¶∞‡¶£ (The Verification Logic)
    window.addEventListener('pageshow', (event) => {
        const lastClickTime = localStorage.getItem(LAST_CLICK_TIME_KEY);
        const lastClickedType = localStorage.getItem(LAST_CLICKED_AD_TYPE_KEY);

        if (lastClickTime && lastClickedType) {
            const timeSpent = Date.now() - parseInt(lastClickTime);

            if (timeSpent >= MIN_VISIT_TIME_MS) {
                // ‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶∏‡¶´‡¶≤
                localStorage.setItem(getVisitedKey(lastClickedType), 'true');
                showNotification("Visit Verified! ‚úÖ");
            } else {
                // ‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá‡¶∞ ‡¶ï‡¶Æ ‡¶π‡¶≤‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•
                showNotification(`Stay at least ${MIN_VISIT_TIME_MS/1000}s to verify! ‚ùå`);
            }

            // ‡¶ü‡ßá‡¶Æ‡ßç‡¶™‡ßã‡¶∞‡¶æ‡¶∞‡¶ø ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞
            localStorage.removeItem(LAST_CLICK_TIME_KEY);
            localStorage.removeItem(LAST_CLICKED_AD_TYPE_KEY);
            
            // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            updateButtonVisibilityAndStatus();
        }
        
        // ‡¶®‡¶∞‡¶Æ‡¶æ‡¶≤ ‡¶≤‡ßã‡¶° ‡¶¨‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü‡¶ì ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
        updateButtonVisibilityAndStatus();
    });

    // ‡ß™. ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function updateButtonVisibilityAndStatus() {
        const adTypes = ['ad1080', 'ad720'];
        let visitedCount = 0;
        let requiredCount = 0;

        // ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
        adTypes.forEach(type => {
            const btn = document.getElementById(`btn-${type}`);
            if (btn) {
                requiredCount++;
                const isVisited = localStorage.getItem(getVisitedKey(type)) === 'true';
                
                if (isVisited) {
                    visitedCount++;
                    btn.classList.add('visited-btn');
                    btn.innerHTML = `VISITED ‚úÖ`;
                    btn.style.opacity = '1'; // ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶Ö‡¶™‡¶æ‡¶∏‡¶ø‡¶ü‡¶ø
                    btn.style.pointerEvents = 'none'; // ‡¶°‡¶ø‡¶ú‡ßá‡¶¨‡¶≤
                } else {
                    btn.classList.remove('visited-btn');
                    btn.style.opacity = '1';
                    btn.style.pointerEvents = 'auto';
                    // ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡ßü ‡¶´‡¶ø‡¶∞‡¶ø‡ßü‡ßá ‡¶Ü‡¶®‡¶æ (Hardcoded for demo, dynamic in reality)
                    if(type === 'ad1080') btn.innerHTML = '<i class="fa-solid fa-cloud-arrow-down" style="margin-right: 5px;"></i> VISIT SERVER 1 (1080p)';
                    if(type === 'ad720') btn.innerHTML = '<i class="fa-solid fa-cloud-arrow-down" style="margin-right: 5px;"></i> VISIT SERVER 2 (720p)';
                }
            }
        });

        // ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï
        const finalBtn = document.getElementById('btn-final');
        if (finalBtn) {
            // ‡¶Ø‡¶¶‡¶ø ‡¶∏‡¶¨ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü
            if (visitedCount >= requiredCount && requiredCount > 0) {
                localStorage.setItem(FINAL_BUTTON_VISIBLE_KEY, 'true');
                finalBtn.style.display = 'flex'; // ‡¶´‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶∏ ‡¶ï‡¶∞‡ßá ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ
                
                // ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¨‡¶æ‡¶ü‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶π‡¶æ‡¶á‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)
                 adTypes.forEach(type => {
                     const btn = document.getElementById(`btn-${type}`);
                     if(btn) btn.style.display = 'none';
                 });
                 
                 // ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
                 const titleDiv = document.querySelector('.download-title-text');
                 if(titleDiv) titleDiv.innerText = "DOWNLOAD UNLOCKED ‚úÖ";

            } else {
                finalBtn.style.display = 'none';
                const titleDiv = document.querySelector('.download-title-text');
                if(titleDiv) titleDiv.innerText = "VISIT LINKS TO UNLOCK DOWNLOAD";
            }
        }
    }

    // ============================================  
    //  EXISTING FUNCTIONALITY (Render, Related, etc)  
    // ============================================  
    const CONFIG = {  
        GLOBAL_VIDEO_LINK: "https://prototypesorting.com/p99vwjq2?key=57217116cccb25526dfb6a5a4edd9aea",  
        TOTAL_RELATED_POSTS: 6,   
        BATCH_SIZE_SCROLL: 6,    
        footer: { about: "#", contact: "#", privacy: "#", terms: "#" }  
    };  
  
    // ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤  
    let availablePosts = [];   
    let currentStartIndex = 0;   
    let observer;   
    let sentinelObserver;   
    let timeElementsToUpdate = [];  
  
    function getRandomColor() { const c=['#1da1f2','#e0245e','#17bf63']; return c[Math.floor(Math.random()*c.length)]; }   
    function formatCount(n) { if(!n) return 0; return n >= 1000000 ? (n/1000000).toFixed(1)+'M' : n >= 1000 ? (n/1000).toFixed(1)+'K' : n; }  
    function timeAgo(dateString) { const d = new Date(dateString); const seconds = Math.floor((new Date() - d) / 1000); let interval = seconds / 31536000; if (interval > 1) return Math.floor(interval) + "y ago"; interval = seconds / 86400; if (interval > 1) return Math.floor(interval) + "d ago"; interval = seconds / 3600; if (interval > 1) return Math.floor(interval) + "h ago"; interval = seconds / 60; if (interval > 1) return Math.floor(interval) + "m ago"; return "Just now"; }  
    function updateAllTimeElements() { timeElementsToUpdate.forEach(item => { if (item.element && item.element.parentNode) { item.element.innerText = timeAgo(item.dateString); } else { timeElementsToUpdate = timeElementsToUpdate.filter(i => i !== item); } }); }  
    function formatDate(d) { return new Date(d).toLocaleDateString('en-US', { year:'numeric', month:'short', day:'numeric' }); }  
    function showNotification(msg) { const n=document.getElementById('notification'); n.innerText=msg; n.classList.add('show'); setTimeout(()=>n.classList.remove('show'),3000); }  
  
    function adjustImageAspectRatio(imgElement) {  
        const mediaContainer = imgElement.closest('.media-container');  
        imgElement.onload = function() {  
            const ratio = this.naturalWidth / this.naturalHeight;  
            if (ratio >= (3 / 4)) { mediaContainer.classList.add('auto-fit'); } else { mediaContainer.classList.remove('auto-fit'); }  
        };  
        if (imgElement.complete) { imgElement.onload(); }  
    }  
      
    // --- ‡¶Æ‡ßá‡¶á‡¶® ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞‡¶ø‡¶Ç (‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶∏‡¶π) ---  
    function renderMainPost(post) {  
        let content = `<h1 class="article-title">${post.title}</h1>`;  
        post.paragraphs.forEach((p) => { content += `<p class="article-para">${p}</p>`; });  
  
        // ‚úÖ ‡¶≤‡¶ú‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞‡¶ø‡¶Ç
        // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ß‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡¶ø downloadLink2 ‡¶π‡¶≤‡ßã 1080p ‡¶è‡¶¨‡¶Ç downloadLink1 ‡¶π‡¶≤‡ßã 720p
        // ‡¶è‡¶¨‡¶Ç Final Link ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ downloadLink1 ‡¶ï‡ßá‡¶á ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡•§
        
        let downloadSectionHTML = '';  
        if (post.downloadLink1 || post.downloadLink2) {  
            downloadSectionHTML += `  
                <div class="download-title-text">VISIT LINKS TO UNLOCK DOWNLOAD</div>  
                <div class="download-buttons-container">  
                    
                    <!-- Ad Button 1 (1080p) -->
                    ${post.downloadLink2 ? `  
                        <div id="btn-ad1080" class="download-btn-v2" 
                             style="background:${getRandomColor()};" 
                             onclick="handleAdClick('ad1080', '${post.downloadLink2}')">  
                            <i class="fa-solid fa-cloud-arrow-down" style="margin-right: 5px;"></i> VISIT SERVER 1 (1080p)  
                        </div>  
                    ` : ''}  
                    
                    <!-- Ad Button 2 (720p) -->
                    ${post.downloadLink1 ? `  
                        <div id="btn-ad720" class="download-btn-v2" 
                             style="background:${getRandomColor()};" 
                             onclick="handleAdClick('ad720', '${post.downloadLink1}')">  
                            <i class="fa-solid fa-cloud-arrow-down" style="margin-right: 5px;"></i> VISIT SERVER 2 (720p)  
                        </div>  
                    ` : ''}  

                    <!-- FINAL DOWNLOAD BUTTON (Initially Hidden) -->
                    <div id="btn-final" class="download-btn-v2 final-download-btn" 
                         onclick="handleFinalDownload('${post.downloadLink1}')">  
                        <i class="fa-solid fa-download" style="margin-right: 5px;"></i> DOWNLOAD NOW  
                    </div>
                </div>  
            `;  
        }  
          
        document.getElementById('post-details-container').innerHTML = `  
            <div class="post-author-area">  
                <div class="author-info">  
                    <div class="pfp"><img src="${PERMANENT_PROFILE_IMAGE_URL}" loading="lazy"></div>  
                    <div class="author-text"><h3>FILMIXO <i class="verified-badge fa-solid fa-circle-check"></i></h3><span>@filmixo</span></div>  
                </div>  
                <div class="post-time" id="main-post-time">${timeAgo(post.uploadTime)}</div>  
            </div>  
            <div class="video-container" onclick="handleVideoClick()"><img src="${post.mediaImage}" loading="lazy"><div class="play-btn-center" id="main-play-btn"></div><div class="main-video-spinner" id="main-spinner"></div><div class="video-controls"><span>${post.videoDuration}</span><span><i class="fa-solid fa-volume-high"></i> HD</span></div></div>  
            <div class="content-body">  
                ${content}  
                ${downloadSectionHTML}   
                <div class="stats-section">  
                    <div class="stats-left">  
                        <div class="view-stat"><i class="fa-solid fa-chart-simple"></i> <span id="view-cnt">...</span> Views</div>  
                        <div class="like-stat-container"><div class="love-btn"><i class="fa-regular fa-heart"></i> <span id="like-cnt">...</span> Likes</div></div>  
                    </div>  
                    <div class="share-icons">  
                        <div class="share-icon" style="background:#1877f2" onclick="share('fb', '${post.title}')"><i class="fa-brands fa-facebook-f"></i></div>  
                        <div class="share-icon" style="background:#0084ff" onclick="share('msg', '${post.title}')"><i class="fa-brands fa-facebook-messenger"></i></div>  
                        <div class="share-icon" style="background:#25d366" onclick="share('wa', '${post.title}')"><i class="fa-brands fa-whatsapp"></i></div>  
                        <div class="share-icon" style="background:#1da1f2" onclick="share('tw', '${post.title}')"><i class="fa-brands fa-twitter"></i></div>  
                        <div class="share-icon" style="background:#0088cc" onclick="share('tg', '${post.title}')"><i class="fa-brands fa-telegram"></i></div>  
                    </div>  
                </div>  
            </div>`;  
          
        const mainTimeElement = document.getElementById('main-post-time');  
        if (mainTimeElement) { timeElementsToUpdate.push({ element: mainTimeElement, dateString: post.uploadTime }); }  
        
        // ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
        updateButtonVisibilityAndStatus();
    }  
  
    // --- ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® ---  
    async function init() {  
        const postContainer = document.getElementById('post-details-container');  
        const mainWrapper = document.querySelector('.main-wrapper');   
        try {  
            const res = await fetch('posts.json');  
            if(!res.ok) throw new Error("Failed to load posts data.");  
            const posts = await res.json();  
            const mainPost = posts.find(p => p.id === postId) || posts[0];  
            if (!mainPost) throw new Error("Post not found.");  
  
            renderMainPost(mainPost);  
            setupFirebaseForMainPost(mainPost.id);  
            mainWrapper.classList.add('loaded');   
            setInterval(updateAllTimeElements, 60000);   
              
            const anchorPostTime = new Date(mainPost.uploadTime).getTime();  
            const historicalPosts = posts.filter(p => p.id !== mainPost.id && new Date(p.uploadTime).getTime() < anchorPostTime).sort((a, b) => new Date(b.uploadTime).getTime() - new Date(a.uploadTime).getTime());  
            availablePosts = historicalPosts.slice(0, CONFIG.TOTAL_RELATED_POSTS);  
            setupRelatedSectionObserver();   
        } catch (e) {   
            postContainer.innerHTML = `<div style="padding:20px;text-align:center;color:red;">Error loading post: ${e.message}</div>`;   
            mainWrapper.classList.add('loaded');   
        }  
    }  
  
    function setupRelatedSectionObserver() {  
        const relatedSection = document.getElementById('related-section-id');  
        observer = new IntersectionObserver((entries, obs) => {  
            if (entries[0].isIntersecting) { obs.unobserve(relatedSection); loadNextBatch(); setupSentinelObserver(); }  
        }, { rootMargin: '100px 0px' });  
        observer.observe(relatedSection);  
    }  
  
    function setupSentinelObserver() {  
        const sentinel = document.getElementById('sentinel');  
        if (availablePosts.length > CONFIG.BATCH_SIZE_SCROLL) {  
            sentinelObserver = new IntersectionObserver((entries) => {  
                if (entries[0].isIntersecting && !sentinel.classList.contains('loading')) { setTimeout(() => loadNextBatch(), 500); }  
            }, { rootMargin: '100px' });  
            sentinelObserver.observe(sentinel);  
        } else { sentinel.style.display = 'none'; }  
    }  
      
    function loadNextBatch() {   
        const sentinel = document.getElementById('sentinel');  
        if (currentStartIndex >= availablePosts.length) { sentinel.style.display = 'none'; return; }  
        sentinel.classList.add('loading');  
        const batchSize = CONFIG.BATCH_SIZE_SCROLL;   
        const endIndex = Math.min(currentStartIndex + batchSize, availablePosts.length);  
        const postsToLoad = availablePosts.slice(currentStartIndex, endIndex);  
        renderBatch(postsToLoad);   
        currentStartIndex = endIndex;  
        sentinel.classList.remove('loading');  
        if (currentStartIndex >= availablePosts.length) { sentinel.style.display = 'none'; if(sentinelObserver) sentinelObserver.unobserve(sentinel); }  
    }  
  
    function renderBatch(postsToLoad) {  
        const container = document.getElementById('related-posts-container');  
        postsToLoad.forEach(post => {  
            let excerpt = post.paragraphs[0].substring(0, 200) + "...";  
            const safeTitle = post.title.replace(/'/g, "\\'");  
            const cardWrapper = document.createElement('div');  
            cardWrapper.innerHTML = `  
                <div class="post-card" data-id="${post.id}">  
                    <div class="post-header">  
                        <div class="post-pfp"><img src="${PERMANENT_PROFILE_IMAGE_URL}" loading="lazy"></div>  
                        <div class="post-meta-text"><div class="name-row"><h3>FILMIXO <i class="verified-badge fa-solid fa-circle-check"></i></h3><span class="post-username">@filmixo</span> <span class="dot-separator">¬∑</span><span class="time-ago" data-upload-time="${post.uploadTime}">${timeAgo(post.uploadTime)}</span></div></div>  
                    </div>  
                    <div class="clickable-area" onclick="openPost('${post.id}')"><div class="post-title">${post.title}</div><div class="post-excerpt">${excerpt} <span class="read-more-text">See more</span></div></div>  
                    <div class="hashtags">${post.hashtags}</div>  
                    <div class="clickable-area" onclick="openPost('${post.id}')"><div class="media-container"><img src="${post.mediaImage}" loading="lazy"><div class="play-icon"></div><div class="duration-badge">${post.videoDuration}</div></div></div>  
                    <div class="post-footer"><div class="footer-left"><i class="fa-solid fa-chart-simple"></i> <span class="count-text view-count-rel">...</span> <span class="label-text">Views</span></div><div class="footer-right"><div class="love-btn-rel"><i class="fa-regular fa-heart"></i> <span class="count-text like-count-rel">...</span> <span class="label-text">Likes</span></div><div class="post-date-display">${formatDate(post.uploadTime)}</div><div class="footer-share-btn" onclick="sharePost('${post.id}', '${safeTitle}')"><i class="fa-solid fa-share-from-square"></i></div></div></div>  
                </div>`;  
            const newCard = cardWrapper.firstElementChild;  
            container.appendChild(newCard);  
            adjustImageAspectRatio(newCard.querySelector('.media-container img'));  
            const timeElement = newCard.querySelector('.time-ago');  
            if (timeElement) { timeElementsToUpdate.push({ element: timeElement, dateString: post.uploadTime }); }  
            setupFirebaseForSingleCard(newCard, post.id);  
        });  
    }  
  
    function setupFirebaseForMainPost(id) {  
        setDoc(doc(db, "views", id), { count: increment(1) }, { merge: true });  
        onSnapshot(doc(db, "views", id), s => document.getElementById('view-cnt').innerText = formatCount(s.data()?.count || 0));  
        const lRef = doc(db, "loves", id), uRef = doc(db, `loves/${id}/users`, deviceId), lBtn = document.querySelector('.love-btn');  
        onSnapshot(lRef, s => document.getElementById('like-cnt').innerText = formatCount(s.data()?.count || 0));  
        getDoc(uRef).then(s => { if(s.exists()) { lBtn.classList.add('liked'); lBtn.querySelector('i').classList.replace('fa-regular','fa-solid'); } });  
        lBtn.addEventListener('click', async () => { if((await getDoc(uRef)).exists()) showNotification("Already Liked! ‚ù§Ô∏è"); else { lBtn.classList.add('liked'); lBtn.querySelector('i').classList.replace('fa-regular','fa-solid'); await setDoc(lRef, { count: increment(1) }, { merge: true }); await setDoc(uRef, { t: new Date() }); showNotification("Liked! ‚ù§Ô∏è"); } });  
    }  
  
    function setupFirebaseForSingleCard(card, id) {  
        const vEl = card.querySelector('.view-count-rel'), lEl = card.querySelector('.like-count-rel'), lBtn = card.querySelector('.love-btn-rel');  
        onSnapshot(doc(db, "views", id), s => vEl.innerText = formatCount(s.data()?.count || 0));  
        const lRef = doc(db, "loves", id), uRef = doc(db, `loves/${id}/users`, deviceId);  
        onSnapshot(lRef, s => lEl.innerText = formatCount(s.data()?.count || 0));  
        getDoc(uRef).then(s => { if(s.exists()) { lBtn.classList.add('liked'); lBtn.querySelector('i').classList.replace('fa-regular','fa-solid'); } });  
        lBtn.addEventListener('click', async () => { if((await getDoc(uRef)).exists()) showNotification("Already Liked! ‚ù§Ô∏è"); else { lBtn.classList.add('liked'); lBtn.querySelector('i').classList.replace('fa-regular','fa-solid'); await setDoc(lRef, { count: increment(1) }, { merge: true }); await setDoc(uRef, { t: new Date() }); showNotification("Liked! ‚ù§Ô∏è"); } });  
    }  
  
    window.handleVideoClick = function() {  
        const p = document.getElementById('main-play-btn'), s = document.getElementById('main-spinner');  
        if(p) p.style.display = 'none'; if(s) s.style.display = 'block';  
        setTimeout(() => { window.location.href = CONFIG.GLOBAL_VIDEO_LINK; }, 100);   
    }  
    // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶•‡ßá‡¶ï‡ßá ‡¶´‡¶ø‡¶∞‡¶≤‡ßá ‡¶∏‡ßç‡¶™‡¶ø‡¶®‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶π‡¶¨‡ßá pageshow ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá
    window.addEventListener('pageshow', () => {  
        const p = document.getElementById('main-play-btn'), s = document.getElementById('main-spinner');  
        if(p) p.style.display = 'flex'; if(s) s.style.display = 'none';  
    });  
  
    window.openPost = (id) => window.location.href = `/movie/post.html?id=${id}`;  
    window.sharePost = (id, title) => { const url = window.location.origin + `/movie/post.html?id=${id}`; if (navigator.share) { navigator.share({ title: title, text: title, url: url }).catch((e) => console.log('Share failed', e)); } else { navigator.clipboard.writeText(url); showNotification("Link copied! üìã"); } }  
    window.share = (platform, title) => {  
        const url = encodeURIComponent(window.location.href); const text = encodeURIComponent(title);  
        if (platform === 'msg') { const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent); if (isMobile) window.location.href = `fb-messenger://share/?link=${url}`; else window.open(`https://www.facebook.com/dialog/send?link=${url}&app_id=123456789&redirect_uri=${url}`, '_blank'); } else { let link = ''; if(platform === 'fb') link = `https://www.facebook.com/sharer/sharer.php?u=${url}`; else if(platform === 'wa') link = `https://wa.me/?text=${text}%20${url}`; else if(platform === 'tw') link = `https://twitter.com/intent/tweet?text=${text}&url=${url}`; else if(platform === 'tg') link = `https://t.me/share/url?url=${url}&text=${text}`; window.open(link, '_blank'); }  
    }  
  
    init();  
</script>  
</body>  
</html>
